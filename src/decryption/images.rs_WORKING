  /// Decodes an encoded image and extracts text.
  ///
  /// This function takes an encoded image as input, decodes it, and extracts text from the image
  /// based on the pixel colors. It supports multiple decoding styles to improve text extraction.
  /// It returns the extracted text as an `Option<String>`. If any decoding style succeeds in
  /// extracting text, the function will return the result immediately.
  ///
  /// Supported Decoding Styles:
  /// - "h": Horizontal style (default).
  /// - "h2": Flips the image vertically for improved text extraction.
  /// - "v": Rotates the image 270 degrees for improved text extraction.
  /// - "v2": Rotates the image 90 degrees and flips it vertically for improved text extraction.
  ///
  /// # Arguments
  ///
  /// * `encoded_image` - The Base64 encoded image to be decoded and processed.
  ///
  /// # Returns
  ///
  /// An `Option<String>` containing the extracted text if successful, or `None` if there was an
  /// error during image decoding or text extraction for all decoding styles.
  ///
  /// # Examples
  ///
  /// ```
  /// use encrypted_images::decryption::images::decode_image_and_extract_text;
  ///
  /// let encoded_image = "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XFy3NXkPuNwBhp50yZAcyU9TKBSA9zP6phwweAsE1tzeWvs4fQAy1NXyDXBwCIwXKXvd4929nb39e6bV3w+ahXK388O8dAAADXZpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+Cjx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IlhNUCBDb3JlIDQuNC4wLUV4aXYyIj4KIDxyZGY6UkRGIHhtbG5zOnJkZj0iaHR0cDovL3d3dy53My5vcmcvMTk5OS8wMi8yMi1yZGYtc3ludGF4LW5zIyI+CiAgPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIKICAgIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIgogICAgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIKICAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgIHhtbG5zOkdJTVA9Imh0dHA6Ly93d3cuZ2ltcC5vcmcveG1wLyIKICAgIHhtbG5zOnRpZmY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vdGlmZi8xLjAvIgogICAgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIgogICB4bXBNTTpEb2N1bWVudElEPSJnaW1wOmRvY2lkOmdpbXA6YjlkYTU4NjAtMWZiNy00NzFjLWEyNjYtODkyMWE1NTVlZmQ4IgogICB4bXBNTTpJbnN0YW5jZUlEPSJ4bXAuaWlkOjlhOGFmMWU4LTJlYzktNGMwNC05NzQ5LWE1ZWE0OGIwNjVkNCIKICAgeG1wTU06T3JpZ2luYWxEb2N1bWVudElEPSJ4bXAuZGlkOjZkYmI4YTE5LWNkNGQtNDFjZi04NWM2LTkyNjNkYTVmYzVlNSIKICAgZGM6Rm9ybWF0PSJpbWFnZS9wbmciCiAgIEdJTVA6QVBJPSIyLjAiCiAgIEdJTVA6UGxhdGZvcm09IldpbmRvd3MiCiAgIEdJTVA6VGltZVN0YW1wPSIxNjk3ODQyNjQ0MzM4OTQyIgogICBHSU1QOlZlcnNpb249IjIuMTAuMzIiCiAgIHRpZmY6T3JpZW50YXRpb249IjEiCiAgIHhtcDpDcmVhdG9yVG9vbD0iR0lNUCAyLjEwIgogICB4bXA6TWV0YWRhdGFEYXRlPSIyMDIzOjEwOjIwVDE2OjU3OjIyLTA2OjAwIgogICB4bXA6TW9kaWZ5RGF0ZT0iMjAyMzoxMDoyMFQxNjo1NzoyMi0wNjowMCI+CiAgIDx4bXBNTTpIaXN0b3J5PgogICAgPHJkZjpTZXE+CiAgICAgPHJkZjpsaQogICAgICBzdEV2dDphY3Rpb249InNhdmVkIgogICAgICBzdEV2dDpjaGFuZ2VkPSIvIgogICAgICBzdEV2dDppbnN0YW5jZUlEPSJ4bXAuaWlkOjFiOGU1NmI3LWQyNjctNGU1OS05ZDQyLWY1MWFkNDExZmYwNiIKICAgICAgc3RFdnQ6c29mdHdhcmVBZ2VudD0iR2ltcCAyLjEwIChXaW5kb3dzKSIKICAgICAgc3RFdnQ6d2hlbj0iMjAyMy0xMC0yMFQxNjo1NzoyNCIvPgogICAgPC9yZGY6U2VxPgogICA8L3htcE1NOkhpc3Rvcnk+CiAgPC9yZGY6RGVzY3JpcHRpb24+CiA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgCjw/eHBhY2tldCBlbmQ9InciPz4g5PjWAAAABmJLR0QA8ADwAPC5DmruAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAB3RJTUUH5woUFjkYVx2T3QAABPhJREFUeNrt2V1PXFUUxvHnWZZSEIpITZpiqyC2xBgqwVpD7IXxwhs/gh/UO9NoJVUb01BTocVWTV+oNpEChekMa3szw5w5c172eZsZZF1MhmSAs8+PP2ufOcPrq984zn2OOWxh43uggXsYrx3gbQjWz4xiyNUw/67DTyM1nPptAqP/7OC9pROo3VKsnxnF67Vn2Jdx7OztouGGsTz2EndeLGDkYAN7c+cxurmGzXNjGHlITH72Prb/2MU2fgdeG8bS2ALWVl8A197C9N172Jj9G8uPFfXJEWxtv8KfD+dwsvEUM4sXMbT1A1aen8aXjXF8++l5NFZ2cXpvCjrzBJcfP8Xt2gWMHGzg3BfzWPtxHdcwgev1KZzSv3BpsY7Gr2O4c+kCPlnbx+2zNXw48QQ/7+xhYewKHvyyjvrsFBqbj/BKHZSzWNx5gLvDxJXpfawMAcPPJzF0cQYnV29i2p3FrdoW3tCruPzODXz3bB7LV9/E/r913L+/ipcffYClRzexWgf49VcfG3CFwCecc4BzcHBwDs1n134u7YH212ges/mAK/tYBdeP8JqR+5wN2IAN2IAN2IAN2IAN2IAN2IAN2IAN2IAN2IAN2IAN2IAN2IAN2IAN2IAN2IAN2IAN2IAN2IAN2IAN2IAN2IAN2IAN2IAN2IAN2IAN2IAN2IAN2IAN2IAN2IDLA2bCAhl6dinf10tglghMAz7mwFISMDOckOQE5lEDZokF0/M1Fig4LzDzAssAAUsfgTUFWHpdMI9RwSxScB7gwwMyGzATgFkCMHMCS2nAbAMzDzBTgFuvFwVmMozEAEuBghkFTE9g/g+AJaVgFih48IDZ34J7DSxlAGvCzsnW6xHA0mNgHoeCpQms0vuC44AlB3DH7zyyI4IJwPQDZsaCI69+GL1ZdhTMbmBG7DmVATMIrN3AJJzTDMCSDEwPYOYEZvhnI4BZGTDjgVXjC2aWgplSsB5TYDo4SsnAMaNGBhyYlQGziekLrPmAe16wxACzCDATgEOLkhBwcAG5C9ZoYKYBMyOwFCi4MLCGgCUauDUaooC1yIiQHgBHFcxeAAscGH855jR09ZBWcGgRIBA4Oe8R4Q3MEDDTgTVwDggBdgEHNnXNDNw6SNwJMqHcJGBUA6wlAbso4EDB9C2YeYAZAmZMuWUBMwaYJRZMP2BtAWtVwMET1t4Ciy8wU4AlP3D1BYeLknzAUmHBwuoK9gGW3MAaARwsWAdkRCQBsxtYywCWqgrOOCIkC7BUCKzpBUtfRoR0Aytj3mDEFKwewOxhwYM9g7NucuJXcCww2//SkgVY/YGFRxmYxYE7CtYKCu4bMEPADAHHPTQFWNrAkhXY9QmYgwRcZcF9Apa8wDwGwMrum1SFCqYfMCsH1gEquLlZShXA2i/gogVrucCpBUvxgmXQgZlWcMTH5sE7e63bjuGrIAkDi1/BTAFmwogQX2D1A2bHgSUjMFOBGQsccUwwR8EMXEPHAUvgXJOApfyCGfWXJcEgMB2YB5gSDcy4EZEAzAhghguWaGChHzCjRoQUA5Y0YI0BVh/gzoLZBaydG2tm4PaNK4ZHhHaPiCAwvYF7WbCmFMyswKHNqkDB4jGDCwBLLmAmAR/uyNoGpi+wRAKL94iQeOBg8YG1dhV8WLInsHYBa2rBPLzZUgTYJQKzrILFc0REvP1NBE4qWKML/g9oRzM1PbxuGwAAAABJRU5ErkJggg==";
  /// let extracted_text = decode_image_and_extract_text(encoded_image);
  /// assert!(extracted_text.is_some());
  /// ```

  use image::{imageops};
  use image::io::Reader as ImageReader;
  use crate::char_mappings::maps::mappings::numbers_to_letter;
  use base64::{Engine as _, engine::{self, general_purpose}, alphabet};
  const CUSTOM_ENGINE: engine::GeneralPurpose =
    engine::GeneralPurpose::new(&alphabet::STANDARD, general_purpose::PAD);

  pub fn decode_image_and_extract_text(encoded_image: &str) -> Option<String> {
    let styles = ["h", "h2", "v", "v2"];
    for &style in &styles {
        if style == "h" {
            if let Some(test) = test_and_return(&encoded_image) { 
                return Some(test)
            }
        } else if style == "h2" {
            let image_data = CUSTOM_ENGINE.decode(&encoded_image).ok()?;
            let img = match image::load(std::io::Cursor::new(&image_data), image::ImageFormat::Png) {
                Ok(img) => img,
                Err(e) => return Some(format!("Error loading image: {}", e)),
            };
            let new_img = imageops::flip_vertical(&img);
            let mut buffer = Vec::new();
            if let Err(e) = image::codecs::png::PngEncoder::new(&mut buffer).encode(&new_img, new_img.width(), new_img.height(), image::ColorType::Rgba8) {
                return Some(format!("Error encoding image: {}", e));
            }
            let encoded_image = CUSTOM_ENGINE.encode(&buffer);
            if let Some(test) = test_and_return(&encoded_image) {
                return Some(test);
            }
        } else if style == "v" {
            let image_data = CUSTOM_ENGINE.decode(&encoded_image).ok()?;
            let img = match image::load(std::io::Cursor::new(&image_data), image::ImageFormat::Png) {
                Ok(img) => img,
                Err(e) => return Some(format!("Error loading image: {}", e)),
            };
            let new_img = imageops::rotate270(&img);
            let mut buffer = Vec::new();
            if let Err(e) = image::codecs::png::PngEncoder::new(&mut buffer).encode(&new_img, new_img.width(), new_img.height(), image::ColorType::Rgba8) {
                return Some(format!("Error encoding image: {}", e));
            }
            let encoded_image = CUSTOM_ENGINE.encode(&buffer);
            if let Some(test) = test_and_return(&encoded_image) {
                return Some(test);
            }
        } else if style == "v2" {
            let image_data = CUSTOM_ENGINE.decode(&encoded_image).ok()?;
            let img = match image::load(std::io::Cursor::new(&image_data), image::ImageFormat::Png) {
                Ok(img) => img,
                Err(e) => return Some(format!("Error loading image: {}", e)),
            };
            let rotated_img = imageops::rotate90(&img);
            let new_img = imageops::flip_vertical(&rotated_img);
            let mut buffer = Vec::new();
            if let Err(e) = image::codecs::png::PngEncoder::new(&mut buffer).encode(&new_img, new_img.width(), new_img.height(), image::ColorType::Rgba8) {
                return Some(format!("Error encoding image: {}", e));
            }
            let encoded_image = CUSTOM_ENGINE.encode(&buffer);
            if let Some(test) = test_and_return(&encoded_image) {
                return Some(test);
            }
        }
    }
    println!("Error Extracting Text");
    return None;
  }

  fn test_and_return(encoded_image: &str) -> Option<String> {
    let image_data = CUSTOM_ENGINE.decode(&encoded_image).ok()?;
    let img = ImageReader::new(std::io::Cursor::new(image_data))
      .with_guessed_format()
      .unwrap()
      .decode()
      .unwrap()
      .to_rgba8();
    let width = img.width();
    let mut extracted_text = String::with_capacity(width as usize);
    for x in 0..width {
      let pixel = img.get_pixel(x, 0);
      let [r, g, b, _] = pixel.0;
      if let Some(c) = numbers_to_letter(r, g, b) {
        extracted_text.push(c);
      }
    }
    if extracted_text.is_empty() {
        return None; // Return None if the string is empty
    }
    let first_char = extracted_text.remove(0);
    extracted_text.push(first_char);
    Some(extracted_text)
  }
